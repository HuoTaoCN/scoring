<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>è¯‰æ±‚å›å¤æ™ºèƒ½è´¨æ£€åŠ©æ‰‹</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>è¯‰æ±‚å›å¤æ™ºèƒ½è´¨æ£€åŠ©æ‰‹</h1>
        
        <!-- åœ¨æ ‡é¢˜ä¸‹æ–¹æ·»åŠ  -->
        <div class="header-links">
            <a href="http://localhost:5001/api_guide" target="_blank" class="api-doc-link">
                <span class="icon">ğŸ“˜</span> APIè°ƒç”¨æŒ‡å—
            </a>
        </div>
        
        <!-- è¯„åˆ†è§„åˆ™å±•ç¤ºåŒº -->
        <div class="rules-section">
            <h2>è¯„åˆ†è§„åˆ™åŠæ ‡å‡†</h2>
            <div class="rules-grid">
                <!-- ç¬¬ä¸€æ  -->
                <div class="rules-column">
                    <div class="rule-item">
                        <h4>1ï¸âƒ£ ç­”éæ‰€é—®ï¼ˆ30åˆ†ï¼‰</h4>
                        <ul>
                            <li>25-30åˆ†ï¼šç²¾å‡†å›åº”</li>
                            <li>15-24åˆ†ï¼šåŸºæœ¬å›åº”ï¼Œç»†èŠ‚ç•¥ç¼º</li>
                            <li>5-14åˆ†ï¼šå¤šå¤„æœªå›åº”æˆ–è·‘é¢˜</li>
                            <li>0-4åˆ†ï¼šä¸¥é‡è·‘é¢˜</li>
                        </ul>
                    </div>
                    <div class="rule-item">
                        <h4>2ï¸âƒ£ å›å¤é€»è¾‘æ€§ï¼ˆ30åˆ†ï¼‰</h4>
                        <ul>
                            <li>25-30åˆ†ï¼šé€»è¾‘ä¸¥è°¨</li>
                            <li>15-24åˆ†ï¼šè¡¨è¾¾å°šå¯</li>
                            <li>5-14åˆ†ï¼šé€»è¾‘ä¸æ¸…</li>
                            <li>0-4åˆ†ï¼šæ··ä¹±æ— åº</li>
                        </ul>
                    </div>
                </div>
                <!-- ç¬¬äºŒæ  -->
                <div class="rules-column">
                    <div class="rule-item">
                        <h4>3ï¸âƒ£ é—®é¢˜è§£å†³æƒ…å†µï¼ˆ10åˆ†ï¼‰</h4>
                        <ul>
                            <li>8-10åˆ†ï¼šå·²è§£å†³ä¸”ç¾¤ä¼—è®¤å¯</li>
                            <li>5-7åˆ†ï¼šå·²è§£å†³ä½†ç¾¤ä¼—ä¸è®¤å¯æˆ–æœªè§£é‡Šå……åˆ†</li>
                            <li>0-4åˆ†ï¼šæœªè§£å†³/è§£å†³ä¸­ï¼Œè¯´æ˜ä¸åˆ°ä½</li>
                        </ul>
                    </div>
                    <div class="rule-item">
                        <h4>4ï¸âƒ£ åŠç†æ—¶é•¿ï¼ˆ10åˆ†ï¼‰</h4>
                        <ul>
                            <li>å’¨è¯¢ç±»ï¼š
                                <ul>
                                    <li>1-2æ—¥ï¼š8-10åˆ†</li>
                                    <li>3-5æ—¥ï¼š6-7åˆ†</li>
                                    <li>è¶…5æ—¥ï¼šæ¯è¶…1å¤©æ‰£2åˆ†</li>
                                </ul>
                            </li>
                            <li>éå’¨è¯¢ç±»ï¼š
                                <ul>
                                    <li>1-4æ—¥ï¼š8-10åˆ†</li>
                                    <li>5-9æ—¥ï¼š6-7åˆ†</li>
                                    <li>10-15æ—¥ï¼š5åˆ†</li>
                                    <li>è¶…15æ—¥ï¼šæ¯è¶…1å¤©æ‰£2åˆ†</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- ç¬¬ä¸‰æ  -->
                <div class="rules-column">
                    <div class="rule-item">
                        <h4>5ï¸âƒ£ å›å¤æ€åº¦ï¼ˆ20åˆ†ï¼‰</h4>
                        <ul>
                            <li>16-20åˆ†ï¼šæ€åº¦å‹å¥½ï¼Œå…³æ€€åˆ°ä½</li>
                            <li>10-15åˆ†ï¼šè¯­æ°”å°šå¯ï¼Œæœ‰å°‘é‡å†·æ¼ </li>
                            <li>5-9åˆ†ï¼šè¾ƒç”Ÿç¡¬å†·æ·¡</li>
                            <li>0-4åˆ†ï¼šæ€ æ…¢ã€æ•·è¡</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- é‡ç‚¹å…³æ³¨è§„åˆ™ï¼ˆå•ç‹¬æ”¾åœ¨ä¸‹æ–¹ï¼‰ -->
            <div class="highlight-rules-section">
                <div class="rule-item highlight-rule">
                    <h4>ğŸš© é‡ç‚¹å…³æ³¨æ ‡è®°è§„åˆ™</h4>
                    <p>ç³»ç»Ÿå°†è‡ªåŠ¨æ ‡è®°éœ€è¦é‡ç‚¹å…³æ³¨çš„å›å¤ï¼Œæ»¡è¶³ä»¥ä¸‹ä»»ä¸€æƒ…å†µå³ä¼šè¢«æ ‡è®°ï¼š</p>
                    <ul>
                        <li>ç­”éæ‰€é—®å¾—åˆ†ä½äº5åˆ†</li>
                        <li>å›å¤é€»è¾‘æ€§å¾—åˆ†ä½äº5åˆ†</li>
                        <li>å›å¤æ€åº¦å¾—åˆ†ä½äº5åˆ†</li>
                        <li>å­˜åœ¨é”™åˆ«å­—</li>
                        <li>å­˜åœ¨è´Ÿé¢è¯è¯­</li>
                    </ul>
                    <p class="rule-note">* æ³¨æ„ï¼šåœ¨å¾—åˆ†ç»´åº¦ä¸­ï¼Œä»…ç­”éæ‰€é—®ã€å›å¤é€»è¾‘æ€§å’Œå›å¤æ€åº¦ä¸‰ä¸ªæŒ‡æ ‡çš„ä½åˆ†ï¼ˆ<5åˆ†ï¼‰ä¼šå¯¼è‡´é‡ç‚¹å…³æ³¨æ ‡è®°ã€‚å…¶ä»–ç»´åº¦çš„ä½åˆ†ä¸ä¼šè§¦å‘é‡ç‚¹å…³æ³¨ã€‚</p>
                </div>
            </div>
        </div>

        <!-- æ–‡ä»¶ä¸Šä¼ åŒº -->
        <div class="upload-section">
            <h2>æ•°æ®ä¸Šä¼ </h2>
            <input type="file" id="fileInput" accept=".xlsx" />
            <button onclick="processFile()">å¼€å§‹è¯„åˆ†</button>
        </div>

        <!-- æ•°æ®é¢„è§ˆåŒº -->
        <div class="preview-section">
            <h2>æ•°æ®é¢„è§ˆ</h2>
            <div id="previewTable"></div>
        </div>

        <!-- è¯„åˆ†ç»“æœåŒº -->
        <div class="results-section">
            <h2>è¯„åˆ†ç»“æœ</h2>
            <div id="resultsTable"></div>
            <button id="exportBtn" onclick="exportResults()" style="display: none;">å¯¼å‡ºç»“æœ</button>
        </div>
    </div>

    <footer class="footer">
        <p>Â© 2024 è¯‰æ±‚å›å¤æ™ºèƒ½è´¨æ£€åŠ©æ‰‹ v0.1.0</p>
    </footer>

    <script>
        let processedData = [];
        let scoringResults = [];

        async function processFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            if (!file) {
                alert('è¯·å…ˆé€‰æ‹©æ–‡ä»¶ï¼');
                return;
            }

            const reader = new FileReader();
            reader.onload = async function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                processedData = XLSX.utils.sheet_to_json(firstSheet);
                
                displayPreview(processedData);
                await scoreData(processedData);
            };
            reader.readAsArrayBuffer(file);
        }

        function displayPreview(data) {
            const previewDiv = document.getElementById('previewTable');
            let html = '<table><tr>';
            
            // è¡¨å¤´
            const headers = Object.keys(data[0]);
            headers.forEach(header => {
                html += `<th>${header}</th>`;
            });
            html += '</tr>';

            // æ•°æ®è¡Œ
            data.forEach(row => {
                html += '<tr>';
                headers.forEach(header => {
                    html += `<td>${row[header]}</td>`;
                });
                html += '</tr>';
            });

            html += '</table>';
            previewDiv.innerHTML = html;
        }

        async function scoreData(data) {
            const resultsDiv = document.getElementById('resultsTable');
            resultsDiv.innerHTML = '<p>è¯„åˆ†ä¸­ï¼Œè¯·ç¨å€™...</p>';
            
            try {
                console.log('å¼€å§‹å‘é€è¯„åˆ†è¯·æ±‚:', data);  // æ·»åŠ æ—¥å¿—
                const response = await axios.post('http://localhost:5001/batch_score', {
                    data: data
                });
                
                console.log('æ”¶åˆ°æœåŠ¡å™¨å“åº”:', response);  // æ·»åŠ æ—¥å¿—
                
                if (response.data && Array.isArray(response.data)) {
                    scoringResults = response.data;
                    displayResults(scoringResults);
                    document.getElementById('exportBtn').style.display = 'block';
                } else {
                    throw new Error('æœåŠ¡å™¨è¿”å›æ•°æ®æ ¼å¼é”™è¯¯');
                }
            } catch (error) {
                console.error('è¯„åˆ†é”™è¯¯:', error);
                let errorMessage = 'è¯„åˆ†å‡ºé”™ï¼š';
                if (error.response) {
                    // æœåŠ¡å™¨è¿”å›é”™è¯¯
                    errorMessage += error.response.data.message || error.response.data.error || error.message;
                    console.error('æœåŠ¡å™¨é”™è¯¯è¯¦æƒ…:', error.response.data);
                } else if (error.request) {
                    // è¯·æ±‚å‘é€å¤±è´¥
                    errorMessage += 'æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œè¯·æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯åŠ¨';
                    console.error('è¯·æ±‚é”™è¯¯:', error.request);
                } else {
                    // å…¶ä»–é”™è¯¯
                    errorMessage += error.message;
                }
                resultsDiv.innerHTML = `<p class="error">${errorMessage}</p>`;
            }
        }

        function displayResults(results) {
            const resultsDiv = document.getElementById('resultsTable');
            if (!results || results.length === 0) {
                resultsDiv.innerHTML = '<p class="error">æ²¡æœ‰è¯„åˆ†ç»“æœ</p>';
                return;
            }

            let html = `
                <table>
                    <tr>
                        <th>åºå·</th>
                        <th>æ€»åˆ†</th>
                        <th>é‡ç‚¹å…³æ³¨</th>
                        <th>è¯¦ç»†è¯„åˆ†</th>
                        <th>æ”¹è¿›å»ºè®®</th>
                    </tr>
            `;
            
            results.forEach((result, index) => {
                if (result.error) {
                    html += `
                        <tr>
                            <td>${index + 1}</td>
                            <td colspan="4" class="error">å¤„ç†å‡ºé”™: ${result.error}</td>
                        </tr>
                    `;
                    return;
                }

                // è®¡ç®—æ€»åˆ†
                const details = result.evaluation_details;
                const calculatedScore = details ? (
                    (details.ç­”éæ‰€é—®?.å¾—åˆ† || 0) +
                    (details.å›å¤é€»è¾‘æ€§?.å¾—åˆ† || 0) +
                    (details.é—®é¢˜è§£å†³æƒ…å†µ?.å¾—åˆ† || 0) +
                    (details.åŠç†æ—¶é•¿?.å¾—åˆ† || 0) +
                    (details.å›å¤æ€åº¦?.å¾—åˆ† || 0)
                ) : 0;

                // å¦‚æœè®¡ç®—çš„æ€»åˆ†ä¸è¿”å›çš„æ€»åˆ†ä¸ä¸€è‡´ï¼Œä½¿ç”¨è®¡ç®—çš„æ€»åˆ†
                const finalScore = calculatedScore;

                // è·å–é‡ç‚¹å…³æ³¨åŸå› 
                const concerns = [];
                let shouldBeConcerned = false;
                
                if (details) {
                    // æ£€æŸ¥ä¸‰ä¸ªä¸»è¦æŒ‡æ ‡çš„å¾—åˆ†
                    if (details.ç­”éæ‰€é—®?.å¾—åˆ† < 5) {
                        concerns.push('ç­”éæ‰€é—®å¾—åˆ†è¿‡ä½');
                        shouldBeConcerned = true;
                    }
                    if (details.å›å¤é€»è¾‘æ€§?.å¾—åˆ† < 5) {
                        concerns.push('å›å¤é€»è¾‘æ€§å¾—åˆ†è¿‡ä½');
                        shouldBeConcerned = true;
                    }
                    if (details.å›å¤æ€åº¦?.å¾—åˆ† < 5) {
                        concerns.push('å›å¤æ€åº¦å¾—åˆ†è¿‡ä½');
                        shouldBeConcerned = true;
                    }

                    // æ£€æŸ¥é”™åˆ«å­—
                    if (details.é”™åˆ«å­—?.å­˜åœ¨) {
                        const errorWords = details.é”™åˆ«å­—.é”™åˆ«å­—åˆ—è¡¨
                            .map(item => `"${item.é”™è¯¯å†™æ³•}"`)
                            .join('ã€');
                        concerns.push(`å­˜åœ¨é”™åˆ«å­—ï¼š${errorWords}`);
                        shouldBeConcerned = true;
                    }

                    // æ£€æŸ¥è´Ÿé¢è¯è¯­
                    const negativeWords = [];
                    if (details.è´Ÿé¢è¯è¯­?.è¯è¯­åˆ—è¡¨) {
                        negativeWords.push(...details.è´Ÿé¢è¯è¯­.è¯è¯­åˆ—è¡¨);
                    }

                    // å»é‡
                    const uniqueNegativeWords = [...new Set(negativeWords)];

                    if (uniqueNegativeWords.length > 0) {
                        concerns.push(`å­˜åœ¨è´Ÿé¢è¯è¯­ï¼š${uniqueNegativeWords.join('ã€')}`);
                        shouldBeConcerned = true;
                    }
                }

                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>
                            <div class="total-score">
                                <span class="score-number">${finalScore}</span>
                                <div class="score-breakdown-tooltip">
                                    ç­”éæ‰€é—®ï¼š${details.ç­”éæ‰€é—®?.å¾—åˆ† || 0}åˆ†<br>
                                    å›å¤é€»è¾‘æ€§ï¼š${details.å›å¤é€»è¾‘æ€§?.å¾—åˆ† || 0}åˆ†<br>
                                    é—®é¢˜è§£å†³æƒ…å†µï¼š${details.é—®é¢˜è§£å†³æƒ…å†µ?.å¾—åˆ† || 0}åˆ†<br>
                                    åŠç†æ—¶é•¿ï¼š${details.åŠç†æ—¶é•¿?.å¾—åˆ† || 0}åˆ†<br>
                                    å›å¤æ€åº¦ï¼š${details.å›å¤æ€åº¦?.å¾—åˆ† || 0}åˆ†
                                </div>
                            </div>
                        </td>
                        <td>
                            ${shouldBeConcerned ? 
                                `<div class="concern-content">
                                    <div class="concern-main">
                                        <div class="concern-tag">âš ï¸ é‡ç‚¹å…³æ³¨</div>
                                        <div class="concern-reasons">
                                            ${concerns.length > 0 ? 
                                                `<div class="concern-list">
                                                    <div class="concern-title">å…³æ³¨åŸå› ï¼š</div>
                                                    ${concerns.map(concern => 
                                                        `<div class="concern-item">${concern}</div>`
                                                    ).join('')}
                                                </div>` : 
                                                '<div class="concern-item">ç³»ç»Ÿåˆ¤å®šä¸ºé‡ç‚¹å…³æ³¨ï¼Œä½†æœªæ‰¾åˆ°å…·ä½“åŸå› </div>'
                                            }
                                        </div>
                                    </div>
                                </div>` : 
                                '<div class="normal-tag">âœ… æ­£å¸¸</div>'
                            }
                        </td>
                        <td>
                            <details onToggle="handleDetailsToggle(this)">
                                <summary>æŸ¥çœ‹è¯¦æƒ…</summary>
                                <div class="score-details">
                                    ${formatScoreDetails(result.evaluation_details)}
                                </div>
                            </details>
                        </td>
                        <td class="suggestion-cell">
                            <div class="suggestions-section">
                                ${result.suggestions ? 
                                    `<div class="suggestion-content">
                                        <span class="suggestion-icon">ğŸ“</span>
                                        ${result.suggestions}
                                    </div>` : 
                                    '<span class="no-suggestion">æ— æ”¹è¿›å»ºè®®</span>'
                                }
                            </div>
                        </td>
                    </tr>
                `;
            });
            
            html += '</table>';
            resultsDiv.innerHTML = html;
        }

        function formatScoreDetails(details) {
            if (!details) return '<p class="error">æ— è¯„åˆ†è¯¦æƒ…</p>';
            
            let html = '<div class="score-breakdown">';
            
            // ä¿®æ”¹åˆ†æ•°é¡¹çš„æ˜¾ç¤ºé€»è¾‘
            const scoreItems = [
                { key: 'ç­”éæ‰€é—®', total: 30 },
                { key: 'å›å¤é€»è¾‘æ€§', total: 30 },
                { key: 'é—®é¢˜è§£å†³æƒ…å†µ', total: 10 },
                { key: 'åŠç†æ—¶é•¿', total: 10 },
                { key: 'å›å¤æ€åº¦', total: 20 }
            ];

            scoreItems.forEach(item => {
                if (details[item.key]) {
                    const score = details[item.key].å¾—åˆ†;
                    // ä¿®æ”¹åˆ¤æ–­æ¡ä»¶ï¼šåªæœ‰å¾—åˆ†ä½äº5åˆ†æ—¶æ‰æ·»åŠ  low-score ç±»
                    html += `
                        <div class="score-item ${score < 5 ? 'low-score' : ''}">
                            <strong>${item.key}ï¼š</strong>
                            <span class="score">${score}/${item.total}åˆ†</span>
                            <div class="comment">${details[item.key].è¯„ä»·}</div>
                        </div>
                    `;
                }
            });

            // é”™åˆ«å­—æ£€æŸ¥
            if (details.é”™åˆ«å­—) {
                html += `
                    <div class="check-item ${details.é”™åˆ«å­—.å­˜åœ¨ ? 'has-issue' : ''}">
                        <strong>é”™åˆ«å­—æ£€æŸ¥ï¼š</strong>
                        ${details.é”™åˆ«å­—.å­˜åœ¨ ? 
                            `<ul>${details.é”™åˆ«å­—.é”™åˆ«å­—åˆ—è¡¨.map(item => 
                                `<li>"${item.é”™è¯¯å†™æ³•}" â†’ "${item.æ­£ç¡®å†™æ³•}"</li>`
                            ).join('')}</ul>` : 
                            'æ— '
                        }
                    </div>
                `;
            }

            // è´Ÿé¢è¯è¯­æ£€æŸ¥ - åŒ…æ‹¬æ–‡æœ¬ä¸­çš„ XXX/YYY
            if (details.è´Ÿé¢è¯è¯­) {
                const negativeWords = [];
                if (details.è´Ÿé¢è¯è¯­.è¯è¯­åˆ—è¡¨) {
                    negativeWords.push(...details.è´Ÿé¢è¯è¯­.è¯è¯­åˆ—è¡¨);
                }
                
                // æ£€æŸ¥æ‰€æœ‰è¯„ä»·æ–‡æœ¬ä¸­æ˜¯å¦åŒ…å« XXX æˆ– YYY
                const allText = [
                    details.ç­”éæ‰€é—®?.è¯„ä»·,
                    details.å›å¤é€»è¾‘æ€§?.è¯„ä»·,
                    details.é—®é¢˜è§£å†³æƒ…å†µ?.è¯„ä»·,
                    details.åŠç†æ—¶é•¿?.è¯„ä»·,
                    details.å›å¤æ€åº¦?.è¯„ä»·
                ].join(' ');

                if (allText.includes('XXX')) {
                    negativeWords.push('XXX');
                }
                if (allText.includes('YYY')) {
                    negativeWords.push('YYY');
                }

                html += `
                    <div class="check-item ${negativeWords.length > 0 ? 'has-issue' : ''}">
                        <strong>è´Ÿé¢è¯è¯­æ£€æŸ¥ï¼š</strong>
                        ${negativeWords.length > 0 ? 
                            `<ul><li>${negativeWords.join('ã€')}</li></ul>` : 
                            'æ— '
                        }
                    </div>
                `;
            }

            html += '</div>';
            return html;
        }

        function exportResults() {
            const wb = XLSX.utils.book_new();
            
            // è½¬æ¢æ•°æ®ä¸ºé€‚åˆå¯¼å‡ºçš„æ ¼å¼
            const exportData = scoringResults.map((result, index) => ({
                'åºå·': index + 1,
                'æ€»åˆ†': result.score,
                'é‡ç‚¹å…³æ³¨': result.é‡ç‚¹å…³æ³¨ ? 'æ˜¯' : 'å¦',
                'ç­”éæ‰€é—®_å¾—åˆ†': result.evaluation_details.ç­”éæ‰€é—®.å¾—åˆ†,
                'ç­”éæ‰€é—®_è¯„ä»·': result.evaluation_details.ç­”éæ‰€é—®.è¯„ä»·,
                'å›å¤é€»è¾‘æ€§_å¾—åˆ†': result.evaluation_details.å›å¤é€»è¾‘æ€§.å¾—åˆ†,
                'å›å¤é€»è¾‘æ€§_è¯„ä»·': result.evaluation_details.å›å¤é€»è¾‘æ€§.è¯„ä»·,
                // ... å…¶ä»–è¯„åˆ†é¡¹
                'å»ºè®®': result.suggestions
            }));
            
            const ws = XLSX.utils.json_to_sheet(exportData);
            XLSX.utils.book_append_sheet(wb, ws, "è¯„åˆ†ç»“æœ");
            
            XLSX.writeFile(wb, "è¯„åˆ†ç»“æœ.xlsx");
        }

        function handleDetailsToggle(detailsElement) {
            const td = detailsElement.parentElement;
            const suggestionTd = td.nextElementSibling;
            
            if (detailsElement.open) {
                td.classList.add('expanded');
                suggestionTd.classList.add('expanded-sibling');
            } else {
                td.classList.remove('expanded');
                suggestionTd.classList.remove('expanded-sibling');
            }
        }
    </script>

    <style>
        .concern-tag {
            color: #ff4444;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .concern-reasons {
            font-size: 0.9em;
            color: #ff4444;
            margin-top: 5px;
        }

        .suggestions-section {
            margin: 0;
            padding: 8px;
            background-color: #f8f9fa;
            border-radius: 4px;
            word-break: break-word;
        }

        .suggestion-content {
            display: flex;
            gap: 8px;
            align-items: flex-start;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .score-details {
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 4px;
            margin-top: 5px;
        }

        /* æ•°æ®é¢„è§ˆè¡¨æ ¼æ ·å¼ */
        .preview-section table {
            table-layout: fixed;
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .preview-section table th,
        .preview-section table td {
            padding: 12px;
            border: 1px solid #eee;
            vertical-align: top;
        }

        /* ç¾¤ä¼—è¯‰æ±‚æ–‡æœ¬åˆ—å®½åº¦æœ€å¤§ */
        .preview-section table th:nth-child(1),
        .preview-section table td:nth-child(1) {
            width: 40%;
        }

        /* ç±»åˆ«åˆ—å›ºå®šå®½åº¦ */
        .preview-section table th:nth-child(2),
        .preview-section table td:nth-child(2) {
            width: 80px;
        }

        /* åŠç†æ—¶é•¿åˆ—å›ºå®šå®½åº¦ */
        .preview-section table th:nth-child(3),
        .preview-section table td:nth-child(3) {
            width: 80px;
            text-align: center;
        }

        /* è¯‰æ±‚å›å¤å†…å®¹åˆ—å®½åº¦è¾ƒå¤§ */
        .preview-section table th:nth-child(4),
        .preview-section table td:nth-child(4) {
            width: 30%;
        }

        /* åŠç†äººå‘˜è‡ªè¯„åˆ—å›ºå®šå®½åº¦ */
        .preview-section table th:nth-child(5),
        .preview-section table td:nth-child(5) {
            width: 100px;
            text-align: center;
        }

        /* ä¸ç¾¤ä¼—æ²Ÿé€šæƒ…å†µåˆ—å›ºå®šå®½åº¦ */
        .preview-section table th:nth-child(6),
        .preview-section table td:nth-child(6) {
            width: 120px;
            text-align: center;
        }

        /* è¯„åˆ†ç»“æœè¡¨æ ¼æ ·å¼ */
        .results-section table {
            table-layout: fixed;
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        /* ä¿®æ”¹åºå·å’Œæ€»åˆ†åˆ—çš„æ ·å¼ */
        .results-section table th:nth-child(1), /* åºå·åˆ— */
        .results-section table td:nth-child(1) {
            width: 60px;
            text-align: center !important; /* å¼ºåˆ¶å±…ä¸­ */
        }

        .results-section table th:nth-child(2), /* æ€»åˆ†åˆ— */
        .results-section table td:nth-child(2) {
            width: 80px;
            text-align: center !important; /* å¼ºåˆ¶å±…ä¸­ */
        }

        .results-section table th:nth-child(3), /* é‡ç‚¹å…³æ³¨åˆ— */
        .results-section table td:nth-child(3) {
            width: 150px;
        }

        /* è¯¦ç»†è¯„åˆ†å’Œæ”¹è¿›å»ºè®®åˆ—çš„åŠ¨æ€å®½åº¦ */
        .results-section table th:nth-child(4), /* è¯¦ç»†è¯„åˆ†åˆ— */
        .results-section table td:nth-child(4) {
            width: 35%;
            transition: width 0.3s ease;
        }

        .results-section table th:nth-child(5), /* æ”¹è¿›å»ºè®®åˆ— */
        .results-section table td:nth-child(5) {
            width: calc(100% - 60px - 80px - 150px - 35%);
            transition: width 0.3s ease;
        }

        /* å½“è¯¦ç»†è¯„åˆ†è¢«å±•å¼€æ—¶è°ƒæ•´å®½åº¦ */
        .results-section table td:nth-child(4).expanded {
            width: 50%;
        }

        .results-section table td:nth-child(5).expanded-sibling {
            width: calc(100% - 60px - 80px - 150px - 50%);
        }

        /* é€šç”¨è¡¨æ ¼æ ·å¼ */
        table th {
            background-color: #f0f7ff;
            font-weight: bold;
            border-bottom: 2px solid #1a73e8;
            white-space: nowrap;
        }

        table td {
            background-color: #fff;
            overflow-wrap: break-word;
        }

        /* éš”è¡Œå˜è‰² */
        table tr:nth-child(even) td {
            background-color: #f8f9fa;
        }

        .score-breakdown {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .score-item {
            padding: 8px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }

        .score-item.low-score {
            background-color: #fff8f8;
            border-left: 3px solid #ff4444;
        }

        .score-item .score {
            font-weight: bold;
            margin: 0 8px;
        }

        .check-item {
            padding: 8px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }

        .check-item.has-issue {
            background-color: #fff8f8;
            border-left: 3px solid #ff4444;
        }

        .check-item ul {
            margin: 5px 0;
            padding-left: 20px;
        }

        .error {
            color: #ff4444;
            padding: 10px;
            background-color: #fff8f8;
            border-radius: 4px;
            margin: 10px 0;
        }

        .rule-note {
            font-size: 0.8em;
            color: #666;
            margin-top: 5px;
        }

        /* æ€»åˆ†æ˜¾ç¤ºçš„æ ·å¼ */
        .total-score {
            position: relative;
            display: flex;          /* ä½¿ç”¨ flex å¸ƒå±€ */
            justify-content: center; /* æ°´å¹³å±…ä¸­ */
            align-items: center;     /* å‚ç›´å±…ä¸­ */
        }

        .score-number {
            font-weight: bold;
            font-size: 1.2em;
            display: inline-block;  /* ç¡®ä¿æ•°å­—æœ¬èº«ä¹Ÿæ˜¯å—çº§å…ƒç´  */
            text-align: center;     /* ç¡®ä¿æ•°å­—å±…ä¸­ */
        }

        /* ç¡®ä¿è¡¨æ ¼å•å…ƒæ ¼å†…å®¹å±…ä¸­ */
        .results-section table td:nth-child(1),
        .results-section table td:nth-child(2) {
            vertical-align: middle; /* å‚ç›´å±…ä¸­ */
        }

        .score-breakdown-tooltip {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 5px;
            z-index: 10;
            display: none;
        }

        .score-breakdown-tooltip:hover {
            display: block;
        }

        /* æ·»åŠ æ ·å¼ */
        .header-links {
            margin: 10px 0 20px;
            text-align: right;
        }

        .api-doc-link {
            display: inline-flex;
            align-items: center;
            padding: 8px 15px;
            background-color: #f0f7ff;
            border: 1px solid #1a73e8;
            border-radius: 4px;
            color: #1a73e8;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .api-doc-link:hover {
            background-color: #1a73e8;
            color: white;
        }

        .api-doc-link .icon {
            margin-right: 8px;
        }
    </style>
</body>
</html> 